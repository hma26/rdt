<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Join ResearchHub - Create Your Account</title>
  <link rel="stylesheet" href="signup.css">
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo">Research<span>Hub</span></a>
      <div class="nav-links">
        <a href="index.html">Home</a>

        <a href="login.html">Sign In</a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <div class="signup-container">
      <!-- Welcome Panel -->
      <div class="welcome-panel">
        <div class="welcome-content">
          <h1>Join the Global Research Community</h1>
          <p>Create your ResearchHub account and connect with brilliant minds worldwide.</p>

          <ul class="welcome-features">
            <li>Share and discover cutting-edge research</li>
            <li>Connect with researchers in your field</li>
            <li>Track citations and research impact</li>
            <li>Collaborate on groundbreaking projects</li>
            <li>Access exclusive academic resources</li>
          </ul>

          <div class="welcome-stats">
            <div class="stat-item">
              <span class="stat-number">50K+</span>
              <span class="stat-label">Researchers</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">200K+</span>
              <span class="stat-label">Publications</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">180+</span>
              <span class="stat-label">Countries</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Signup Form Panel -->
      <div class="signup-form-panel">
        <div class="form-header">
          <h2>Create Your Account</h2>
          <p>Join thousands of researchers advancing science together</p>
        </div>

        <form class="signup-form">
          <!-- Quick Signup Options -->
          <div class="quick-signup">
            <a href="#" class="btn-social btn-institution">
              üè´ Sign up with Institution
            </a>
            <a href="#" class="btn-social">
              <svg width="18" height="18" viewBox="0 0 24 24">
                <path fill="#4285F4"
                  d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                <path fill="#34A853"
                  d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                <path fill="#FBBC05"
                  d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                <path fill="#EA4335"
                  d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
              </svg>
              Continue with Google
            </a>
          </div>

          <div class="divider">
            <span>Or create account manually</span>
          </div>

          <!-- Personal Information -->
          <div class="form-row">
            <div class="form-group">
              <label for="firstName" class="form-label required">First Name</label>
              <input type="text" id="firstName" class="form-input" placeholder="Your first name" required>
            </div>
            <div class="form-group">
              <label for="lastName" class="form-label required">Last Name</label>
              <input type="text" id="lastName" class="form-input" placeholder="Your last name" required>
            </div>
          </div>

          <div class="form-group">
            <label for="email" class="form-label required">Email Address</label>
            <input type="email" id="email" class="form-input" placeholder="your.email@university.edu" required>
          </div>

          <div class="form-group">
            <label for="password" class="form-label required">Password</label>
            <input type="password" id="password" class="form-input" placeholder="Create a strong password" required>
          </div>

          <!-- Academic Information -->
          <div class="form-group">
            <label for="institution" class="form-label required">Institution</label>
            <input type="text" id="institution" class="form-input" placeholder="Your university or organization"
              required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="department" class="form-label">Department</label>
              <input type="text" id="department" class="form-input" placeholder="Computer Science">
            </div>
            <div class="form-group">
              <label for="position" class="form-label">Position</label>
              <select id="position" class="form-select">
                <option value="">Select position</option>
                <option value="graduate-student">Graduate Student</option>
                <option value="phd-student">PhD Student</option>
                <option value="postdoc">Postdoctoral Researcher</option>
                <option value="assistant-professor">Assistant Professor</option>
                <option value="associate-professor">Associate Professor</option>
                <option value="professor">Professor</option>
                <option value="researcher">Research Scientist</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>



          <!-- Research Interests -->
          <div class="form-group">
            <label for="interests-input" class="form-label">Research Interests</label>
            <div class="tag-input-container">
              <div id="tags-container" class="tags-container">
                <!-- Dynamically added tags will go here -->
              </div>
              <input type="text" id="interests-input" class="form-input"
                placeholder="Type an interest and press Enter (e.g., AI, Cloud Computing)">
            </div>
            <div id="suggestions-panel" class="suggestions-panel">
              <!-- Search suggestions will appear here -->
            </div>
          </div>

          <!-- Terms and Conditions -->
          <div class="terms-section">
            <div class="checkbox-wrapper">
              <input type="checkbox" id="terms" name="terms" required>
              <label for="terms">
                I agree to the <a href="#" target="_blank">Terms of Service</a> and acknowledge the <a href="#"
                  target="_blank">Privacy Policy</a>
              </label>
            </div>
            <div class="checkbox-wrapper">
              <input type="checkbox" id="updates" name="updates">
              <label for="updates">
                I'd like to receive updates about new features and research opportunities
              </label>
            </div>
          </div>

          <button type="submit" class="btn-primary">
            üöÄ Create Account
          </button>
        </form>

        <div class="login-link">
          <p>Already have an account? <a href="login.html">Sign in here</a></p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>¬© 2025 ResearchHub ‚Äî Connecting researchers worldwide</p>
  </footer>
  <!-- Add this to the end of signup.html, before </body> -->
  <script>
    // --- Research Interests Tag Input Logic ---

    // 1. A predefined list of possible interests for suggestions
    const allInterests = [
      'Artificial Intelligence', 'Machine Learning', 'Cloud Computing', 'Cybersecurity',
      'Data Science', 'Bioinformatics', 'Quantum Computing', 'Robotics', 'IoT',
      'Blockchain', 'Web Development', 'Mobile Development', 'Game Development',
      'Computer Vision', 'Natural Language Processing', 'Big Data', 'DevOps',
      'Software Engineering', 'Computer Graphics', 'Human-Computer Interaction'
    ];

    // 2. References to our HTML elements
    const interestsInput = document.getElementById('interests-input');
    const tagsContainer = document.getElementById('tags-container');
    const suggestionsPanel = document.getElementById('suggestions-panel');

    // 3. An array to store the user's selected interests
    let selectedInterests = [];

    // 4. Function to render the tags
    function renderTags() {
      tagsContainer.innerHTML = ''; // Clear existing tags
      selectedInterests.forEach(interest => {
        const tagElement = document.createElement('div');
        tagElement.className = 'tag';
        tagElement.innerHTML = `
                ${interest}
                <button type="button" class="remove-tag" data-interest="${interest}">&times;</button>
            `;
        tagsContainer.appendChild(tagElement);
      });
    }

    // 5. Function to add a new tag
    function addTag(interest) {
      // Trim whitespace and capitalize first letters for consistency
      const formattedInterest = interest.trim()
        .split(' ')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
        .join(' ');

      if (formattedInterest && !selectedInterests.includes(formattedInterest)) {
        selectedInterests.push(formattedInterest);
        renderTags();
      }
      interestsInput.value = ''; // Clear the input field
      suggestionsPanel.style.display = 'none'; // Hide suggestions
    }

    // 6. Function to handle input and show suggestions
    interestsInput.addEventListener('input', () => {
      const query = interestsInput.value.toLowerCase();
      if (query.length < 2) {
        suggestionsPanel.style.display = 'none';
        return;
      }

      const filteredInterests = allInterests.filter(interest =>
        interest.toLowerCase().includes(query) && !selectedInterests.includes(interest)
      );

      if (filteredInterests.length > 0) {
        suggestionsPanel.innerHTML = '';
        filteredInterests.forEach(interest => {
          const item = document.createElement('div');
          item.className = 'suggestion-item';
          item.textContent = interest;
          item.addEventListener('click', () => addTag(interest));
          suggestionsPanel.appendChild(item);
        });
        suggestionsPanel.style.display = 'block';
      } else {
        suggestionsPanel.style.display = 'none';
      }
    });

    // 7. Event listener for the input field (handling "Enter")
    interestsInput.addEventListener('keydown', (event) => {
      if (event.key === 'Enter' && interestsInput.value) {
        event.preventDefault(); // Prevent form submission
        addTag(interestsInput.value);
      }
    });

    // 8. Event listener for removing tags (using event delegation)
    tagsContainer.addEventListener('click', (event) => {
      if (event.target.classList.contains('remove-tag')) {
        const interestToRemove = event.target.dataset.interest;
        selectedInterests = selectedInterests.filter(interest => interest !== interestToRemove);
        renderTags();
      }
    });

    // 9. Hide suggestions if the user clicks elsewhere
    document.addEventListener('click', (event) => {
      if (!event.target.closest('.tag-input-container')) {
        suggestionsPanel.style.display = 'none';
      }
    });

    //---- the singup logic 


    const signupForm = document.querySelector('.signup-form');

    signupForm.addEventListener('submit', async (event) => {
      event.preventDefault(); // Prevent default page reload

      // 1. Gather all the data from the form
      const formData = {
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        handle: document.getElementById('email').value.split('@')[0], // Create a default handle
        institution: document.getElementById('institution').value,
        department: document.getElementById('department').value,
        position: document.getElementById('position').value,
        interests: selectedInterests, // This comes from our tag input logic
      };

      // 2. Send the data to the backend
      try {
        const response = await fetch('http://localhost:3001/auth/signup', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formData),
        });

        const data = await response.json();

        if (!response.ok) {
          // Show server error message (e.g., "Email already in use")
          alert(`Signup failed: ${data.message}`);
          throw new Error(data.message);
        }

        // 3. SUCCESS!
        alert('Account created successfully! Please log in.');
        window.location.href = 'login.html'; // Redirect to login page

      } catch (error) {
        console.error('An error occurred during signup:', error);
        // You can add an error message display on the page here
      }
    });
  </script>
</body>

</html>